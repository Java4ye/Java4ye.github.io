<!-- build time:Sat Jan 22 2022 15:53:41 GMT+0800 (GMT+08:00) --><!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="///cdn.jsdelivr.net/gh/RyzeYang/CDN_blog@3.0/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="///cdn.jsdelivr.net/gh/RyzeYang/CDN_blog@3.0/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="baidu-site-verification" content="code-PP6xh7YWaY"><link rel="alternate" type="application/rss+xml" title="程序员小站" href="https://www.java4ye.cn/rss.xml"><link rel="alternate" type="application/atom+xml" title="程序员小站" href="https://www.java4ye.cn/atom.xml"><link rel="alternate" type="application/json" title="程序员小站" href="https://www.java4ye.cn/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="https://www.java4ye.cn/Spring/Spring%20AOP%E5%86%85%E5%8A%9F%E4%BF%AE%E7%82%BC/"><title>Spring AOP内功修炼 - Spring家族 | Java4ye = 程序员小站 = 4ye的后端技术小站</title><meta name="generator" content="Hexo 6.0.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Spring AOP内功修炼</h1><div class="meta"><span class="item" title="Created: 2022-01-20 22:57:28"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">Posted on</span> <time itemprop="dateCreated datePublished" datetime="2022-01-20T22:57:28+08:00">2022-01-20</time> </span><span class="item" title="Symbols count in article"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">Symbols count in article</span> <span>3.1k</span> <span class="text">words</span> </span><span class="item" title="Reading time"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">Reading time</span> <span>3 mins.</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="Toggle navigation bar"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Java4ye</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicliwyw55j20zk0m8hdt.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gicivghyooj20zk0m8dir.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giclfb3vzhj20zk0m8wny.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1giciuv0socj20zk0m8qes.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipeudstjqj20zk0m8k3r.jpg"></li><li class="item" data-background-image="https://tva4.sinaimg.cn/large/6833939bly1gipeybxm1pj20zk0m8niv.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">Home</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Spring/" itemprop="item" rel="index" title="In Spring家族"><span itemprop="name">Spring家族</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="en"><link itemprop="mainEntityOfPage" href="https://www.java4ye.cn/Spring/Spring%20AOP%E5%86%85%E5%8A%9F%E4%BF%AE%E7%82%BC/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="///cdn.jsdelivr.net/gh/RyzeYang/CDN_blog@3.0/images/avatar.png"><meta itemprop="name" content="Java4ye"><meta itemprop="description" content="4ye的后端技术小站, 整理公众号Java4ye 的文章,方便复习查阅😋"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="程序员小站"></span><div class="body md" itemprop="articleBody"><p>哈哈 终于更到这里了 🐷</p><p>今天来和小伙伴们分享这个 <strong>Spring AOP</strong> 的知识点 👇</p><p><img data-src="http://img.ryzeyang.top/image-20210913072321674.png" alt="image-20210913072321674"></p><p>这里先推荐大家去阅读 <strong>Spring</strong> 的官方文档，<strong>core</strong> 文档的 5，6 章节， 和 <strong>AOP</strong> 相关的概念都可以这这里找到～，还有我们要了解的 <strong>Spring AOP APIs</strong> 😄</p><p><img data-src="http://img.ryzeyang.top/image-20210910074335232.png" alt="image-20210910074335232"></p><p>先来介绍下这个 <strong>AOP</strong> 😄</p><h3 id="aop-概念"><a class="anchor" href="#aop-概念">#</a> AOP 概念</h3><p>这是个老生常谈的问题呀 哈哈 熟悉的小伙伴们可以略过😄</p><blockquote><p>面向切面编程 <strong>Aspect-Oriented Programming</strong> ，是对 <strong>OOP</strong> 的一种补充</p><p>使用场景有 ： <strong>日志</strong> ，<strong>事务</strong> ， <strong>权限认证</strong> ， <strong>缓存</strong> 等</p></blockquote><p>而 <strong>Spring AOP</strong> 呢，会通过这个 <strong>代理类</strong> 来实现对方法的<strong>增强</strong> 👇</p><p><img data-src="http://img.ryzeyang.top/image-20210910073611972.png" alt="image-20210910073611972"></p><p>这里有很重要的几个概念 👇(看图就好啦)</p><p><img data-src="http://img.ryzeyang.top/image-20210910074649844.png" alt="image-20210910074649844"></p><h3 id="概念关系图"><a class="anchor" href="#概念关系图">#</a> 概念关系图</h3><p>通过 <strong>PointCut</strong> 去匹配符合的 <strong>JoinPoint</strong> ，再对其做 <strong>Weaving</strong>・操作，将 <strong>Advice</strong> 织入其中。</p><p>而 <strong>PointCut</strong> 和 <strong>Advice</strong> 存放在 <strong>Aspect</strong> 中。</p><p><img data-src="http://img.ryzeyang.top/image-20210910081828619.png" alt="image-20210910081828619"></p><h3 id="切点表达式图"><a class="anchor" href="#切点表达式图">#</a> 切点表达式图</h3><p>如：<strong>execution</strong> ，<strong>within</strong> ， <strong>this</strong> ，<strong>target</strong> ，<strong>args</strong> ，<strong>bean</strong></p><p>以及<strong>匹配注解</strong>用的 <strong>@target</strong> ，<strong>@args</strong> ，<strong>@within</strong> ， <strong>@annotation</strong></p><h4 id="execution"><a class="anchor" href="#execution">#</a> execution</h4><blockquote><p>作用： 匹配 某些连接点</p></blockquote><p>如：</p><ul><li>execution (public * *(..)) 作用： 匹配所有公共方法</li><li>execution (* set*(..)) 作用：匹配所有 set 开头的方法</li><li>execution (* com.xyz.service.AccountService.*(..)) 作用：匹配 AccountService 中的所有方法</li><li>execution(* com.xyz.service.<em>.</em>(..)) 作用：匹配 service 包中的所有方法</li><li>execution(* com.xyz.service..<em>.</em>(..)) 作用：匹配 service 包和它的子包中 所有的方法</li></ul><h4 id="within"><a class="anchor" href="#within">#</a> within</h4><blockquote><p>作用：匹配 类 中的所有 连接点</p></blockquote><p>如：</p><ul><li>within (com.xyz.service.*) 作用：匹配 service 包中的所有方法</li><li>within (com.xyz.service..*) 作用：匹配 service 包和它的子包中 所有的方法</li></ul><h4 id="this"><a class="anchor" href="#this">#</a> this</h4><blockquote><p>作用：匹配 代理类</p></blockquote><ul><li>this (com.xyz.service.AccountService) 作用：匹配 实现了 AccountService 接口的 代理类，即 父类是 AccountService</li></ul><h4 id="target"><a class="anchor" href="#target">#</a> target</h4><blockquote><p>作用：匹配 被代理类</p></blockquote><ul><li>target (com.xyz.service.AccountService) 作用：匹配 实现了 AccountService 接口的 被代理类，即 父类是 AccountService</li></ul><h4 id="args"><a class="anchor" href="#args">#</a> args</h4><blockquote><p>作用：匹配 方法参数</p></blockquote><ul><li>args (java.io.Serializable) 作用：匹配 单个方法参数，且是 Serializable 类型的</li></ul><h4 id="bean"><a class="anchor" href="#bean">#</a> bean</h4><blockquote><p>作用：匹配 bean 名称，Spring 扩展 AspectJ 的 PDC 规范， 只能在 Spring AOP 中生效</p></blockquote><h4 id="target-2"><a class="anchor" href="#target-2">#</a> @target</h4><blockquote><p>作用：匹配 有注解的 被代理类</p></blockquote><ul><li>@target (org.springframework.transaction.annotation.Transactional) 作用：匹配 @Transactional 注解的 被代理类</li></ul><h4 id="args-2"><a class="anchor" href="#args-2">#</a> @args</h4><blockquote><p>作用：匹配 传入的参数 有某个注解</p></blockquote><ul><li>@args (com.xyz.security.Classified) 作用： 匹配有 @Classified 注解的参数</li></ul><h4 id="within-2"><a class="anchor" href="#within-2">#</a> @within</h4><blockquote><p>作用：匹配 有某个注解 的 类</p></blockquote><ul><li>@within (org.springframework.transaction.annotation.Transactional) 作用： 匹配 有 @Transactional 注解 的 类中的所有 连接点</li></ul><h4 id="annotation"><a class="anchor" href="#annotation">#</a> @annotation</h4><blockquote><p>作用：匹配 该注解</p></blockquote><ul><li>@annotation (org.springframework.transaction.annotation.Transactional) 作用： 匹配 @Transactional 注解</li></ul><p>小结图如下 👇</p><p><img data-src="http://img.ryzeyang.top/image-20210910082639157.png" alt="image-20210910082639157"></p><h3 id="advice-注解图"><a class="anchor" href="#advice-注解图">#</a> Advice 注解图</h3><p>这里是常用的五个注解</p><p>注意：<strong>@After</strong> 等于 <strong>finally</strong> 语句块，必定会执行，还有 <strong>@Around</strong> 注解时，方法的第一个参数必须是 <strong>ProceedingJoinPoint</strong> ，它是 <strong>JoinPoint</strong> 的子接口</p><p><img data-src="http://img.ryzeyang.top/image-20210913074020835.png" alt="image-20210913074020835"></p><hr><blockquote><p>下面的内容是本文的重点～😝</p></blockquote><h3 id="编程式-aop"><a class="anchor" href="#编程式-aop">#</a> 编程式 AOP</h3><p>这个呢，是我们写 <strong>AOP 插件</strong> 的基础</p><p><img data-src="http://img.ryzeyang.top/image-20210912074920354.png" alt="image-20210912074920354"></p><p>这里要理解这几个概念 👇</p><ul><li><strong>Pointcut</strong> : <strong>对应 @Pointcut</strong></li><li><strong>Advice</strong> ：<strong>对应 @Before，@After，@Around 等等</strong></li><li><strong>Advisor</strong> ：<strong>@Aspect 注解解析后的类，等于 Pointcut + Advice</strong> 🐷</li><li><strong>Advised</strong> : <strong>Spring AOP 代理类都可以转换成该接口！</strong> 🐷</li></ul><p>例子我放到 <strong>Github</strong> 上啦 ，地址放文末啦👇</p><h3 id="pointcut"><a class="anchor" href="#pointcut">#</a> Pointcut</h3><p>里面有两个返回类型式 <strong>ClassFilter</strong> 和 <strong>MethodMatcher</strong> 的方法，他们的作用如下 👇</p><p><img data-src="http://img.ryzeyang.top/image-20210912100228554.png" alt="image-20210912100228554"></p><p>4ye 也是大概了解下 哈哈 主要还是用 Spring 提供的实现类，如下面例子中用到的 <strong>NameMatchMethodPointcut</strong> ，看名字就能猜个大概，就是匹配这个方法名的 😄</p><h4 id="小例子"><a class="anchor" href="#小例子">#</a> 小例子</h4><p>代码例子比较多，这里就举这个 <strong>Pointcut</strong> 看看就好啦～（其他案例代码小伙伴们可以自行在我的 Github 仓库上获取😄）</p><blockquote><p>通过对 ProxyFactroy 添加 <strong>切面</strong> 来对目标 sayService 做增强，这里的 Pointcut 只针对 setName 方法</p></blockquote><p><img data-src="http://img.ryzeyang.top/AOP_Pointcut.png" alt="AOP_Pointcut"></p><h4 id="效果"><a class="anchor" href="#效果">#</a> 效果</h4><p>可以看到只增强了 setName 方法</p><p><img data-src="http://img.ryzeyang.top/image-20210912094544020.png" alt="image-20210912094544020"></p><h3 id="advice"><a class="anchor" href="#advice">#</a> Advice</h3><p>可以看到这里 Spring 提供了这 五种类型。除了最后一种 Introduction 类型上面没提到外，是不是还发现少了一种类型😝</p><p><img data-src="http://img.ryzeyang.top/image-20210912161447604.png" alt="image-20210912161447604"></p><p>没错，就是这个 <strong>@After</strong> 注解对应的<strong>最终通知</strong> 😱</p><p>这去哪了呀 (￣﹏￣；)</p><p>在源码中寻找一番后，发现了这个 <strong>AspectJAfterAdvice</strong> 👇</p><p><img data-src="http://img.ryzeyang.top/image-20210912104757851.png" alt="image-20210912104757851"></p><blockquote><p>可以看到这里不仅实现了 <strong>AfterAdvice</strong> 接口，还要实现这个 <strong>MethodInterceptor</strong> 接口 ，最后真的是在 <strong>finally</strong> 语句块中实现了这个<strong>增强操作</strong>，来达到 <strong>最终通知</strong> 的效果！</p></blockquote><p>所以我们需要 <strong>最终通知</strong> 效果的话，可以直接模仿它去实现就好了～</p><p>而 Introduction Advice 这个还挺特别的🐖</p><blockquote><p>作用：为代理类实现新的接口</p><p>等于 <strong>@DeclareParents</strong> 注解</p></blockquote><h3 id="advisor"><a class="anchor" href="#advisor">#</a> Advisor</h3><p>作用 👇</p><blockquote><p>@Aspect 注解解析后的类，等于 Pointcut + Advice</p></blockquote><h3 id="advised"><a class="anchor" href="#advised">#</a> Advised</h3><p>作用 👇</p><blockquote><p>AOP 代理类都可以转换成该接口</p></blockquote><h4 id="为啥这些代理对象都能转换成这个-advised-接口"><a class="anchor" href="#为啥这些代理对象都能转换成这个-advised-接口">#</a> 为啥这些代理对象都能转换成这个 <strong>Advised</strong> 接口？</h4><p>答案当然不言而喻 哈哈，咱们来源码中看看 Spring 是怎么写的😝</p><h4 id="jdk"><a class="anchor" href="#jdk">#</a> JDK</h4><p><img data-src="http://img.ryzeyang.top/image-20210911231149301.png" alt="image-20210911231149301"></p><h4 id="cglib"><a class="anchor" href="#cglib">#</a> Cglib</h4><p><img data-src="http://img.ryzeyang.top/image-20210911233943416.png" alt="image-20210911233943416"></p><h4 id="结论"><a class="anchor" href="#结论">#</a> 结论</h4><blockquote><p>可以发现，不管是 JDK 还是 Cglib , 都会去调用同一个方法，为代理类多实现几个接口，其中一个就是 <strong>Advised</strong> 😋</p></blockquote><h3 id="关系图"><a class="anchor" href="#关系图">#</a> 关系图</h3><p><img data-src="http://img.ryzeyang.top/SpringAOP.png" alt="SpringAOP"></p><h3 id="最后"><a class="anchor" href="#最后">#</a> 最后</h3><p>本文就分享到这里啦🐖</p><p>重点内容在 <strong>编程式 AOP</strong> 这一块～内功 + 1 😋</p><p>代码可以在这里获取 👇 可以自己多跑跑代码，会有更多问题等着你发现的！</p><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0phdmE0eWUvc3ByaW5nYm9vdC1kZW1vLTR5ZS90cmVlL21haW4vc3ByaW5nYm9vdC1hb3A=">https://github.com/Java4ye/springboot-demo-4ye/tree/main/springboot-aop</span></p><p>思维导图 👇</p><p><span class="exturl" data-url="aHR0cDovL3Byb2Nlc3Nvbi5jb20vY2hhcnRfaW1hZ2UvNjEzNGQ2Y2I3ZDljMDgxYzc1M2I1ZDU0LnBuZw==">http://processon.com/chart_image/6134d6cb7d9c081c753b5d54.png</span></p><p>ps：这次分享的时候居然出现了 <strong>Gateway Timeout</strong> 异常 ，如果等不及官方修复的话，可以在网盘获取</p><p><strong>链接</strong>：<span class="exturl" data-url="aHR0cHM6Ly9wYW4uYmFpZHUuY29tL3MvMUtWV3cwRGFZQ0tySVNJS0pncXF5dUE=">https://pan.baidu.com/s/1KVWw0DaYCKrISIKJgqqyuA</span></p><p><strong>提取码</strong> 需在公众号后台回复 <code>bdwp</code></p><p><img data-src="http://img.ryzeyang.top/image-20210913074314344.png" alt="image-20210913074314344"></p><p>插件的部分代码我也上传啦，就差这画画图写写文啦 哈哈 (这两天应该就安排上了)😆</p><blockquote><p>喜欢的话可以 <strong>关注</strong> 并 <strong>星标</strong> 下公众号 <strong>Java4ye</strong> 支持下 <strong>4ye</strong> 呀😝，这样就可以第一时间收到更文消息啦🐷</p></blockquote><p><strong>我是 4ye 咱们下期应该…… 很快再见！！</strong> 😆</p></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">Edited on</span> <time title="Modified: 2022-01-20 23:00:03" itemprop="dateModified" datetime="2022-01-20T23:00:03+08:00">2022-01-20</time> </span><span id="Spring/Spring AOP内功修炼/" class="item leancloud_visitors" data-flag-title="Spring AOP内功修炼" title="Views"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">Views</span> <span class="leancloud-visitors-count"></span> <span class="text">times</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> Donate</button><p>Give me a cup of [coffee]~(￣▽￣)~*</p><div id="qr"><div><img data-src="///cdn.jsdelivr.net/gh/RyzeYang/CDN_blog@3.0/images/wechatpay.png" alt="Java4ye WeChat Pay"><p>WeChat Pay</p></div><div><img data-src="///cdn.jsdelivr.net/gh/RyzeYang/CDN_blog@3.0/images/alipay.png" alt="Java4ye Alipay"><p>Alipay</p></div></div></div><div id="copyright"><ul><li class="author"><strong>Post author: </strong>Java4ye <i class="ic i-at"><em>@</em></i>程序员小站</li><li class="link"><strong>Post link: </strong><a href="https://www.java4ye.cn/Spring/Spring%20AOP%E5%86%85%E5%8A%9F%E4%BF%AE%E7%82%BC/" title="Spring AOP内功修炼">https://www.java4ye.cn/Spring/Spring AOP内功修炼/</a></li><li class="license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/Spring/AOP+MybatisPlus%20%E4%BC%98%E5%8C%96%E7%89%B9%E6%AE%8A%E7%9A%84%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclgrvbd6j20zk0m8qv5.jpg" title="AOP+MybatisPlus 优化特殊的日志模块"><span class="type">Previous Post</span> <span class="category"><i class="ic i-flag"></i> Spring家族</span><h3>AOP+MybatisPlus 优化特殊的日志模块</h3></a></div><div class="item right"><a href="/Spring/%E4%B8%89%E5%88%86%E9%92%9F%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8BSpring%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1gipetfk5zwj20zk0m8e81.jpg" title="三分钟快速上手Spring事件机制"><span class="type">Next Post</span> <span class="category"><i class="ic i-flag"></i> Spring家族</span><h3>三分钟快速上手Spring事件机制</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="Contents"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#aop-%E6%A6%82%E5%BF%B5"><span class="toc-number">1.</span> <span class="toc-text">AOP 概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5%E5%85%B3%E7%B3%BB%E5%9B%BE"><span class="toc-number">2.</span> <span class="toc-text">概念关系图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%87%E7%82%B9%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9B%BE"><span class="toc-number">3.</span> <span class="toc-text">切点表达式图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#execution"><span class="toc-number">3.1.</span> <span class="toc-text">execution</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#within"><span class="toc-number">3.2.</span> <span class="toc-text">within</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#this"><span class="toc-number">3.3.</span> <span class="toc-text">this</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#target"><span class="toc-number">3.4.</span> <span class="toc-text">target</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#args"><span class="toc-number">3.5.</span> <span class="toc-text">args</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bean"><span class="toc-number">3.6.</span> <span class="toc-text">bean</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#target-2"><span class="toc-number">3.7.</span> <span class="toc-text">@target</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#args-2"><span class="toc-number">3.8.</span> <span class="toc-text">@args</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#within-2"><span class="toc-number">3.9.</span> <span class="toc-text">@within</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#annotation"><span class="toc-number">3.10.</span> <span class="toc-text">@annotation</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#advice-%E6%B3%A8%E8%A7%A3%E5%9B%BE"><span class="toc-number">4.</span> <span class="toc-text">Advice 注解图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E7%A8%8B%E5%BC%8F-aop"><span class="toc-number">5.</span> <span class="toc-text">编程式 AOP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pointcut"><span class="toc-number">6.</span> <span class="toc-text">Pointcut</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%8F%E4%BE%8B%E5%AD%90"><span class="toc-number">6.1.</span> <span class="toc-text">小例子</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%88%E6%9E%9C"><span class="toc-number">6.2.</span> <span class="toc-text">效果</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#advice"><span class="toc-number">7.</span> <span class="toc-text">Advice</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#advisor"><span class="toc-number">8.</span> <span class="toc-text">Advisor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#advised"><span class="toc-number">9.</span> <span class="toc-text">Advised</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%BA%E5%95%A5%E8%BF%99%E4%BA%9B%E4%BB%A3%E7%90%86%E5%AF%B9%E8%B1%A1%E9%83%BD%E8%83%BD%E8%BD%AC%E6%8D%A2%E6%88%90%E8%BF%99%E4%B8%AA-advised-%E6%8E%A5%E5%8F%A3"><span class="toc-number">9.1.</span> <span class="toc-text">为啥这些代理对象都能转换成这个 Advised 接口？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#jdk"><span class="toc-number">9.2.</span> <span class="toc-text">JDK</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#cglib"><span class="toc-number">9.3.</span> <span class="toc-text">Cglib</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%93%E8%AE%BA"><span class="toc-number">9.4.</span> <span class="toc-text">结论</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E5%9B%BE"><span class="toc-number">10.</span> <span class="toc-text">关系图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%90%8E"><span class="toc-number">11.</span> <span class="toc-text">最后</span></a></li></ol></div><div class="related panel pjax" data-title="Related"><ul><li><a href="/Spring/16%E5%BC%A0%E5%9B%BE%E8%A7%A3%E9%94%81Spring%E7%9A%84%E6%95%B4%E4%BD%93%E8%84%89%E7%BB%9C%E5%95%A6/" rel="bookmark" title="16张图解锁Spring的整体脉络">16张图解锁Spring的整体脉络</a></li><li><a href="/Spring/AOP%20%E6%8F%92%E4%BB%B6%E5%B0%B1%E8%BF%99%EF%BC%9F%E4%B8%8A%E6%89%8B%E4%B8%8D%E7%94%A8%E4%B8%A4%E5%88%86%E9%92%9F%EF%BC%81%EF%BC%81%20/" rel="bookmark" title="AOP 插件就这？上手不用两分钟！！">AOP 插件就这？上手不用两分钟！！</a></li><li><a href="/Spring/%E5%9B%9B%E7%A7%8D%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E5%9C%A8Springboot%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/" rel="bookmark" title="四种引用类型在Springboot中的使用">四种引用类型在Springboot中的使用</a></li><li><a href="/Spring/%E4%B8%89%E5%88%86%E9%92%9F%E5%BF%AB%E9%80%9F%E4%BA%86%E8%A7%A3Spring%E4%B8%AD%E7%9A%84%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/" rel="bookmark" title="三分钟快速了解Spring中的工厂模式">三分钟快速了解Spring中的工厂模式</a></li><li><a href="/Spring/%E7%AE%80%E5%8D%95%E4%B8%A4%E6%AD%A5%E6%90%9E%E5%AE%9ASpringboot%E8%87%AA%E5%AE%9A%E4%B9%89starter/" rel="bookmark" title="简单两步搞定Springboot自定义starter.md">简单两步搞定Springboot自定义starter.md</a></li><li><a href="/Spring/%E8%8A%B1%E4%BA%86%202%20%E4%B8%AA%E9%92%9F%E6%89%8D%E6%90%9E%E6%87%82%E8%BF%99%20AOP%20%E4%B8%BA%E5%95%A5%E6%B2%A1%E7%94%9F%E6%95%88%EF%BC%8C%E6%B0%B4%E5%8F%8B%E5%8D%B4%E7%9D%A1%E7%9D%80%E4%BA%86%E2%80%A6%E2%80%A6/" rel="bookmark" title="花了 2 个钟才搞懂这 AOP 为啥没生效，水友却睡着了……">花了 2 个钟才搞懂这 AOP 为啥没生效，水友却睡着了……</a></li><li><a href="/Spring/AOP+MybatisPlus%20%E4%BC%98%E5%8C%96%E7%89%B9%E6%AE%8A%E7%9A%84%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97/" rel="bookmark" title="AOP+MybatisPlus 优化特殊的日志模块">AOP+MybatisPlus 优化特殊的日志模块</a></li><li class="active"><a href="/Spring/Spring%20AOP%E5%86%85%E5%8A%9F%E4%BF%AE%E7%82%BC/" rel="bookmark" title="Spring AOP内功修炼">Spring AOP内功修炼</a></li><li><a href="/Spring/%E4%B8%89%E5%88%86%E9%92%9F%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8BSpring%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6/" rel="bookmark" title="三分钟快速上手Spring事件机制">三分钟快速上手Spring事件机制</a></li></ul></div><div class="overview panel" data-title="Overview"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Java4ye" data-src="///cdn.jsdelivr.net/gh/RyzeYang/CDN_blog@3.0/images/avatar.png"><p class="name" itemprop="name">Java4ye</p><div class="description" itemprop="description">整理公众号Java4ye 的文章,方便复习查阅😋</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">28</span> <span class="name">posts</span></a></div><div class="item categories"><a href="/categories/"><span class="count">7</span> <span class="name">categories</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0phdmE0eWU=" title="https:&#x2F;&#x2F;github.com&#x2F;Java4ye"><i class="ic i-github"></i></span> <span class="exturl item weixin" data-url="aHR0cDovL2ltZy5yeXpleWFuZy50b3AvaW1hZ2UtMjAyMTA4MDcxODMyMDM3MzYucG5n" title="http:&#x2F;&#x2F;img.ryzeyang.top&#x2F;image-20210807183203736.png"><i class="ic i-weixin"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>Home</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>Posts</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>Archives</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>Categories</a></li></ul></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/Spring/AOP+MybatisPlus%20%E4%BC%98%E5%8C%96%E7%89%B9%E6%AE%8A%E7%9A%84%E6%97%A5%E5%BF%97%E6%A8%A1%E5%9D%97/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/Spring/%E4%B8%89%E5%88%86%E9%92%9F%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8BSpring%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>Random Posts</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/DB/" title="In DB领域">DB领域</a></div><span><a href="/DB/MySQL%E5%90%84%E5%A4%A7%E7%89%88%E6%9C%AC%E6%96%B0%E7%89%B9%E6%80%A7%E4%B8%80%E8%A7%88/" title="MySQL各大版本新特性一览">MySQL各大版本新特性一览</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Spring/" title="In Spring家族">Spring家族</a></div><span><a href="/Spring/%E4%B8%89%E5%88%86%E9%92%9F%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8BSpring%E4%BA%8B%E4%BB%B6%E6%9C%BA%E5%88%B6/" title="三分钟快速上手Spring事件机制">三分钟快速上手Spring事件机制</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Java/" title="In Java">Java</a></div><span><a href="/Java/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F%E5%85%AB%E4%B8%AA%E4%BE%8B%E5%AD%90/" title="单例模式八个例子">单例模式八个例子</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Spring/" title="In Spring家族">Spring家族</a></div><span><a href="/Spring/%E4%B8%89%E5%88%86%E9%92%9F%E5%BF%AB%E9%80%9F%E4%BA%86%E8%A7%A3Spring%E4%B8%AD%E7%9A%84%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/" title="三分钟快速了解Spring中的工厂模式">三分钟快速了解Spring中的工厂模式</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/python/" title="In python">python</a></div><span><a href="/Python/pycharm%E6%AD%A3%E7%A1%AE%E9%85%8D%E7%BD%AE%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F%E6%BA%90%E7%9A%84%E6%96%B9%E5%BC%8F/" title="pycharm正确配置国内镜像源的方式">pycharm正确配置国内镜像源的方式</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/python/" title="In python">python</a></div><span><a href="/Python/python%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0%E5%9B%9B/" title="python3入门笔记四之函数式编程---高阶函数，返回函数，匿名函数，装饰器，偏函数">python3入门笔记四之函数式编程---高阶函数，返回函数，匿名函数，装饰器，偏函数</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Spring/" title="In Spring家族">Spring家族</a></div><span><a href="/Spring/%E8%8A%B1%E4%BA%86%202%20%E4%B8%AA%E9%92%9F%E6%89%8D%E6%90%9E%E6%87%82%E8%BF%99%20AOP%20%E4%B8%BA%E5%95%A5%E6%B2%A1%E7%94%9F%E6%95%88%EF%BC%8C%E6%B0%B4%E5%8F%8B%E5%8D%B4%E7%9D%A1%E7%9D%80%E4%BA%86%E2%80%A6%E2%80%A6/" title="花了 2 个钟才搞懂这 AOP 为啥没生效，水友却睡着了……">花了 2 个钟才搞懂这 AOP 为啥没生效，水友却睡着了……</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/python/" title="In python">python</a></div><span><a href="/Python/python%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0%E5%85%AD/" title="python3入门笔记六之面向对象编程">python3入门笔记六之面向对象编程</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/SearchEngine/" title="In 搜索引擎">搜索引擎</a></div><span><a href="/SearchEngine/ElasticSearch%E4%B8%AD%E5%BF%85%E9%A1%BB%E6%8E%8C%E6%8F%A1%E7%9A%84%E4%B8%83%E4%B8%AA%E6%A6%82%E5%BF%B5/" title="ElasticSearch中必须掌握的七个概念">ElasticSearch中必须掌握的七个概念</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/python/" title="In python">python</a></div><span><a href="/Python/python%E5%85%A5%E9%97%A8%E7%AC%94%E8%AE%B0%E4%B8%89/" title="python3入门笔记三之高级特性---切片，迭代，列表生成式，生成器，迭代器">python3入门笔记三之高级特性---切片，迭代，列表生成式，生成器，迭代器</a></span></li></ul></div><div><h2>Recent Comments</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; <span itemprop="copyrightYear">2022</span> <span class="with-love"><i class="ic i-heart rotate"></i> </span><span class="author" itemprop="copyrightHolder">Java4ye @ Java4ye</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="Symbols count total">89k words</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="Reading time total">1:21</span></div><div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"Spring/Spring AOP内功修炼/",favicon:{show:"（。＾▽＾）",hide:"(　o=^•ェ•)o　┏━┓"},search:{placeholder:"Search for Posts",empty:"We didn't find any results for the search: ${query}",stats:"${hits} results found in ${time} ms"},valine:!0,fancybox:!0,copyright:'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->